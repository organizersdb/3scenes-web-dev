import{g as f,j as e,n as g,r as m,A as h,a as j,L as C}from"./index-DRR2ciDs.js";import{B as S,S as T}from"./BaseCard-ByUQUbAa.js";import{P as b}from"./ProposalDetail-CSYVgAj3.js";import"./ProposalContent-DUzlgRCN.js";import"./Avatar-DzGO4EEC.js";import"./Separator-C5vIcpzW.js";import"./SceneCard-CIrGpZac.js";import"./index-CDqgC5ys.js";const v=({id:a,script:i,status:o="draft",jobTitle:l,createdAt:s,updatedAt:u,onSelect:n})=>{const c=f();if(!a)return null;const p=r=>({buttonText:r==="draft"?"編輯投稿":"查看投稿",handleClick:()=>{r==="draft"&&c(`/proposal/${a}/edit`),r==="submitted"&&n(a)}}),{buttonText:d,handleClick:x}=p(o),t=()=>{if(o==="draft")return`創立日期：${g(s||0)}`;if(o==="submitted")return`提交日期：${g(u||0)}`};return e.jsx(S,{title:(i==null?void 0:i.title)||"",subtitle:l||"",status:o,buttonText:d,onButtonClick:x,timeText:t()})},D=()=>{var d,x;const{authUser:a,authSwrFetcher:i}=m.useContext(h),[o,l]=m.useState(null),[s,u]=m.useState({page:0,pageSize:100,searchText:""}),{data:n,isLoading:c}=j(`/proposal?page=${s.page}&pageSize=${s.pageSize}&searchText=${s.searchText}&screenwriterId=${(d=a==null?void 0:a.screenwriter)==null?void 0:d.id}`,i),p=m.useCallback(t=>{u(r=>({...r,searchText:t}))},[]);return a?!n||c?e.jsx(e.Fragment,{}):e.jsxs("div",{className:"grid-col grid gap-y-4 py-4 md:p-4",children:[e.jsx("div",{className:"flex flex-col items-center gap-y-2 md:flex-row md:justify-between md:gap-y-0",children:e.jsx("h1",{children:"我的投稿"})}),e.jsx(T,{value:s.searchText??"",onChange:p}),e.jsx("div",{children:c?e.jsx(C,{}):(x=n==null?void 0:n.data)==null?void 0:x.sort((t,r)=>t.createdAt&&r.createdAt?r.createdAt-t.createdAt:0).map(t=>e.jsx(v,{...t,onSelect:l},t.id))}),e.jsx(b,{proposal:n.data.find(t=>t.id===o),onClose:()=>l(null)})]}):e.jsx(e.Fragment,{})};export{D as default};
